<ion-modal-view ng-controller="ICalUploadCtrl">
    <ion-header-bar>
        <h1 class="title">Upload iCal file</h1>
    </ion-header-bar>
    <!-- This is a hack how to know what modal is this template for - for some bookkeeping, at the time of writing - 20160729 - in calendar.js -->
    <ion-content class="modalNamingSearch" name="uploadIcal">
        <form name="icalUploadForm" novalidate ng-keyup="$root.keyUpHandler($event.keyCode, !$root.icalFile);">
            <div class="list customFormErrorList">
                <div ng-show="icalUploadForm.file.$error.required && !icalUploadForm.file.$pristine" class="item help-block">Please provide a valid file.</div>
                <div ng-show="errorInfo" class="item help-block help-block-error item-no-wrap">
                    {{errorInfo}}
                </div>
            </div>
            <!-- This is a horrible hack, but without this, keyup event won't fire -->
            <input type="text" style="position:absolute;top:-10000px;" id="primaryInput"/>

            <div class="list">
                <label class="item item-input" ng-class="{ 'has-error' : icalUploadForm.file.$invalid && !icalUploadForm.file.$pristine }">
                    <div class="input-label">
                        iCalendar File
                    </div>
                    <input type="file" file-model="$root.icalFile" id="uploadedFileEdit" required name="uploadedFile" accept=".ical,.ics" class="inputfile">
                    <span class="inputfile-label">{{$root.icalFile ? $root.icalFile.name : 'Choose an iCalendar file'}}</span>
                </label>
                <ion-item class="item item-text item-no-wrap">
                    <h2>How will your file be processed?</h2>
                    <ul>
                        <li><span>Only events in future will be imported.</span></li>
                        <li><span>Only events that occur no later than {{weeksFromSettings}} weeks in the future will be imported.</span></li>
                        <li><span>Events will be imported respecting their time zone.</span></li>
                        <li><span>Only events that have not been previously imported will be imported.</span></li>
                    </ul>
                </ion-item>
            </div>

            <div class="row">
                <div class="col-50 padding-horizontal padding-top">
                    <button class="button button-block button-positive" ng-disabled="!$root.icalFile" ng-click="confirmModal('uploadIcal');">
                        Save
                    </button>

                </div>
                <div class="col-50 padding-horizontal padding-top">
                    <button class="button button-block button-outline button-stable" ng-click="closeModal('uploadIcal');">
                        Cancel
                    </button>   
                </div>
            </div>
        </form>
    </ion-content>
</ion-modal-view>